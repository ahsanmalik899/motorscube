<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="back()">
        <ion-icon name="arrow-back-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>Create Store</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="container" style="padding: 16px;">
    <form [formGroup]="storeForm" (ngSubmit)="onSubmit()" novalidate>

      <!-- Store Name -->
      <div class="input-group" [class.focused]="storeForm.get('store_name')?.value || isFocused['store_name']">
        <ion-icon name="storefront-outline" class="input-icon"></ion-icon>
        <input
          type="text"
          id="store_name"
          class="text-field"
          placeholder=" "
          formControlName="store_name"
          (focus)="onInputFocus('store_name')"
          (blur)="onInputBlur('store_name')"
          required
          autocomplete="off"
        />
        <label for="store_name">Store Name *</label>
      </div>
      <ion-text color="danger" *ngIf="isControlInvalid('store_name')">
        <p class="error-message">Store Name is required.</p>
      </ion-text>

      <!-- City -->
      <div class="input-group" [class.focused]="storeForm.get('city')?.value || isFocused['city']">
        <ion-icon name="location-outline" class="input-icon"></ion-icon>
        <input
          type="text"
          id="city"
          class="text-field"
          placeholder=" "
          formControlName="city"
          (focus)="onInputFocus('city')"
          (blur)="onInputBlur('city')"
          required
          autocomplete="off"
        />
        <label for="city">City *</label>
      </div>
      <ion-text color="danger" *ngIf="isControlInvalid('city')">
        <p class="error-message">City is required.</p>
      </ion-text>

      <!-- Address -->
      <div class="input-group" [class.focused]="storeForm.get('address')?.value || isFocused['address']">
        <ion-icon name="map-outline" class="input-icon"></ion-icon>
        <input
          type="text"
          id="address"
          class="text-field"
          placeholder=" "
          formControlName="address"
          (focus)="onInputFocus('address')"
          (blur)="onInputBlur('address')"
          required
          autocomplete="off"
        />
        <label for="address">Address *</label>
      </div>
      <ion-text color="danger" *ngIf="isControlInvalid('address')">
        <p class="error-message">Address is required.</p>
      </ion-text>

      <!-- Email -->
      <div class="input-group" [class.focused]="storeForm.get('email')?.value || isFocused['email']">
        <ion-icon name="mail-outline" class="input-icon"></ion-icon>
        <input
          type="email"
          id="email"
          class="text-field"
          placeholder=" "
          formControlName="email"
          (focus)="onInputFocus('email')"
          (blur)="onInputBlur('email')"
          required
          autocomplete="off"
        />
        <label for="email">Email *</label>
      </div>
      <ion-text color="danger" *ngIf="isControlInvalid('email')">
        <p class="error-message" *ngIf="storeForm.get('email')?.errors?.['required']">Email is required.</p>
        <p class="error-message" *ngIf="storeForm.get('email')?.errors?.['email']">Please enter a valid email.</p>
      </ion-text>

      <!-- Mobile -->
      <div class="input-group" [class.focused]="storeForm.get('mobile')?.value || isFocused['mobile']">
        <ion-icon name="call-outline" class="input-icon"></ion-icon>
        <input
          type="tel"
          id="mobile"
          class="text-field"
          placeholder=" "
          formControlName="mobile"
          (focus)="onInputFocus('mobile')"
          (blur)="onInputBlur('mobile')"
          required
          autocomplete="off"
        />
        <label for="mobile">Mobile *</label>
      </div>
      <ion-text color="danger" *ngIf="isControlInvalid('mobile')">
        <p class="error-message">Mobile number is required.</p>
      </ion-text>

      <!-- Store Detail -->
      <div class="input-group" [class.focused]="storeForm.get('store_detail')?.value || isFocused['store_detail']">
        <ion-icon name="document-text-outline" class="input-icon"></ion-icon>
        <textarea
          id="store_detail"
          class="text-field"
          placeholder=" "
          formControlName="store_detail"
          (focus)="onInputFocus('store_detail')"
          (blur)="onInputBlur('store_detail')"
        ></textarea>
        <label for="store_detail">Store Detail</label>
      </div>

      <!-- Website -->
     
      <ion-text color="danger" *ngIf="isControlInvalid('web')">
        <p class="error-message">Please enter a valid URL.</p>
      </ion-text>

      <!-- Select Option -->
<!-- Select Option -->
<div class="input-group" [class.focused]="storeForm.get('select_option')?.value || isFocused['select_option']">
  <ion-icon name="list-outline" class="input-icon"></ion-icon>

  <ion-select
    formControlName="select_option"
    id="select_option"
    interface="popover"
    placeholder="Select Type *"
    class="text-field"
    (ionFocus)="onInputFocus('select_option')"
    (ionBlur)="onInputBlur('select_option')"
  >
    <ion-select-option value="Easy Paisa">Easy Paisa</ion-select-option>
    <ion-select-option value="Jazz Cash">Jazz Cash</ion-select-option>
  </ion-select>

  <label for="select_option">Select Type *</label>
</div>

<!-- Display Selected Icon -->
<div *ngIf="storeForm.get('select_option')?.value" style="margin-top: 8px; display: flex; align-items: center;">
  <img
    [src]="iconMap[storeForm.get('select_option')?.value]"
    alt="Selected Icon"
    style="width: 24px; height: 24px; margin-right: 8px;"
  />
  <span>{{ storeForm.get('select_option')?.value }}</span>
</div>

<ion-text color="danger" *ngIf="isControlInvalid('select_option')">
  <p class="error-message">Please select a store type.</p>
</ion-text>


      <ion-text color="danger" *ngIf="isControlInvalid('select_option')">
        <p class="error-message">Please select a store type.</p>
      </ion-text>

      <!-- Bank Name -->
      <div class="input-group" [class.focused]="storeForm.get('bank_name')?.value || isFocused['bank_name']">
        <ion-icon name="card-outline" class="input-icon"></ion-icon>
        <input
          type="text"
          id="bank_name"
          class="text-field"
          placeholder=" "
          formControlName="bank_name"
          (focus)="onInputFocus('bank_name')"
          (blur)="onInputBlur('bank_name')"
          autocomplete="off"
        />
        <label for="bank_name">Bank Name</label>
      </div>

      <!-- Account -->
      <div class="input-group" [class.focused]="storeForm.get('account')?.value || isFocused['account']">
        <ion-icon name="cash-outline" class="input-icon"></ion-icon>
        <input
          type="text"
          id="account"
          class="text-field"
          placeholder=" "
          formControlName="account"
          (focus)="onInputFocus('account')"
          (blur)="onInputBlur('account')"
          autocomplete="off"
        />
        <label for="account">Account Number</label>
      </div>

      <!-- JazzCash -->
      <div class="input-group" [class.focused]="storeForm.get('jazzcash')?.value || isFocused['jazzcash']">
        <ion-icon name="logo-usd" class="input-icon"></ion-icon>
        <input
          type="text"
          id="jazzcash"
          class="text-field"
          placeholder=" "
          formControlName="jazzcash"
          (focus)="onInputFocus('jazzcash')"
          (blur)="onInputBlur('jazzcash')"
          autocomplete="off"
        />
        <label for="jazzcash">JazzCash</label>
      </div>

      <!-- Logo Upload -->
      <div class="upload-group" style="position: relative; margin: 16px 0;">
        <input
          type="file"
          accept="image/*"
          id="logo-upload"
          (change)="onFileChange($event, 'logo')"
          style="opacity: 0; width: 100%; height: 40px; position: absolute; top: 0; left: 0; cursor: pointer; z-index: 2;"
        />
        <label
          for="logo-upload"
          class="upload-label"
          style="display: inline-flex; align-items: center; gap: 8px; cursor: pointer; position: relative; z-index: 1;"
        >
          <ion-icon name="image-outline"></ion-icon> Upload Logo
        </label>
        <div *ngIf="preview.logo" class="image-preview" style="margin-top: 8px;">
          <img [src]="preview.logo" alt="Logo Preview" style="max-width: 100%; max-height: 150px;"/>
        </div>
      </div>

      <!-- Cover Image Upload -->
      <div class="upload-group" style="position: relative; margin: 16px 0;">
        <input
          type="file"
          accept="image/*"
          id="cover-upload"
          (change)="onFileChange($event, 'cover_image')"
          style="opacity: 0; width: 100%; height: 40px; position: absolute; top: 0; left: 0; cursor: pointer; z-index: 2;"
        />
        <label
          for="cover-upload"
          class="upload-label"
          style="display: inline-flex; align-items: center; gap: 8px; cursor: pointer; position: relative; z-index: 1;"
        >
          <ion-icon name="images-outline"></ion-icon> Upload Cover Image
        </label>
        <div *ngIf="preview.cover_image" class="image-preview" style="margin-top: 8px;">
          <img [src]="preview.cover_image" alt="Cover Image Preview" style="max-width: 100%; max-height: 150px;"/>
        </div>
      </div>

      <!-- Submit Button -->
      <ion-button type="submit" [disabled]="storeForm.invalid" expand="block" style="margin-top: 24px;">
        <ion-icon name="checkmark-done-outline"></ion-icon>
        <span>Create Store</span>
      </ion-button>

    </form>
  </div>
</ion-content>
